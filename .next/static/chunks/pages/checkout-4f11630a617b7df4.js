(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[222],{5248:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/checkout",function(){return t(6089)}])},6089:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return m}});var a=t(5893),l=t(9008),n=t.n(l),i=t(1664),d=t.n(i),c=t(7294),r=t(1163),o=t(977),x=t(9548);function m(){let e=(0,r.useRouter)(),{cart:s,cartTotal:t,clearCart:l}=(0,o.j)(),{user:i,loading:m}=(0,x.a)(),[h,u]=(0,c.useState)(!1),[p,j]=(0,c.useState)(""),[y,f]=(0,c.useState)({address:"",city:"",zip:"",country:"United States"}),g=async t=>{t.preventDefault(),u(!0),j("");try{let t=localStorage.getItem("token"),a=await fetch("/api/orders",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({items:s.map(e=>({productId:e.id,quantity:e.quantity})),shippingAddress:y.address,shippingCity:y.city,shippingZip:y.zip,shippingCountry:y.country})}),n=await a.json();a.ok?(l(),e.push("/orders/".concat(n.orderId,"?success=true"))):j(n.error||"Failed to place order")}catch(e){j("Something went wrong. Please try again.")}u(!1)};if((0,c.useEffect)(()=>{m||i||e.replace("/login?redirect=/checkout")},[m,i,e]),m||!m&&!i)return null;if(0===s.length)return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n(),{children:(0,a.jsx)("title",{children:"Checkout - Melodic Instruments"})}),(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16 text-center",children:[(0,a.jsx)("h1",{className:"text-3xl font-display font-bold text-secondary-900 mb-4",children:"Your cart is empty"}),(0,a.jsx)(d(),{href:"/products",className:"btn-primary",children:"Continue Shopping"})]})]});let b=t>=500?0:49.99,N=.08*t,v=t+b+N;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n(),{children:(0,a.jsx)("title",{children:"Checkout - Melodic Instruments"})}),(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,a.jsx)("h1",{className:"section-title mb-8",children:"Checkout"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,a.jsx)("div",{children:(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-secondary-900 mb-6",children:"Shipping Information"}),p&&(0,a.jsx)("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg text-red-600",children:p}),(0,a.jsxs)("form",{onSubmit:g,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-secondary-700 mb-1",children:"Street Address"}),(0,a.jsx)("input",{type:"text",required:!0,value:y.address,onChange:e=>f({...y,address:e.target.value}),className:"input-field",placeholder:"123 Music Lane"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-secondary-700 mb-1",children:"City"}),(0,a.jsx)("input",{type:"text",required:!0,value:y.city,onChange:e=>f({...y,city:e.target.value}),className:"input-field",placeholder:"Nashville"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-secondary-700 mb-1",children:"ZIP Code"}),(0,a.jsx)("input",{type:"text",required:!0,value:y.zip,onChange:e=>f({...y,zip:e.target.value}),className:"input-field",placeholder:"37203"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-secondary-700 mb-1",children:"Country"}),(0,a.jsxs)("select",{value:y.country,onChange:e=>f({...y,country:e.target.value}),className:"input-field",children:[(0,a.jsx)("option",{children:"United States"}),(0,a.jsx)("option",{children:"Canada"}),(0,a.jsx)("option",{children:"United Kingdom"}),(0,a.jsx)("option",{children:"Australia"}),(0,a.jsx)("option",{children:"Germany"}),(0,a.jsx)("option",{children:"France"})]})]}),(0,a.jsx)("hr",{className:"my-6"}),(0,a.jsx)("h2",{className:"text-lg font-semibold text-secondary-900 mb-4",children:"Payment Information"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-secondary-700 mb-1",children:"Card Number"}),(0,a.jsx)("input",{type:"text",className:"input-field",placeholder:"4242 4242 4242 4242",defaultValue:"4242 4242 4242 4242"}),(0,a.jsx)("p",{className:"text-xs text-secondary-500 mt-1",children:"Demo mode - no real payment"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-secondary-700 mb-1",children:"Expiry Date"}),(0,a.jsx)("input",{type:"text",className:"input-field",placeholder:"MM/YY",defaultValue:"12/28"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-secondary-700 mb-1",children:"CVC"}),(0,a.jsx)("input",{type:"text",className:"input-field",placeholder:"123",defaultValue:"123"})]})]}),(0,a.jsx)("button",{type:"submit",disabled:h,className:"btn-primary w-full mt-6 disabled:opacity-50",children:h?"Processing...":"Place Order â€¢ $".concat(v.toFixed(2))})]})]})}),(0,a.jsx)("div",{children:(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6 sticky top-24",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-secondary-900 mb-4",children:"Order Summary"}),(0,a.jsx)("div",{className:"space-y-4 max-h-64 overflow-auto",children:s.map(e=>(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-gray-100 rounded-lg overflow-hidden flex-shrink-0",children:(0,a.jsx)("img",{src:e.image_url,alt:e.name,className:"w-full h-full object-cover"})}),(0,a.jsxs)("div",{className:"flex-grow",children:[(0,a.jsx)("p",{className:"font-medium text-secondary-900",children:e.name}),(0,a.jsxs)("p",{className:"text-sm text-secondary-500",children:["Qty: ",e.quantity]})]}),(0,a.jsxs)("p",{className:"font-medium text-secondary-900",children:["$",(e.price*e.quantity).toLocaleString()]})]},e.id))}),(0,a.jsx)("hr",{className:"my-4"}),(0,a.jsxs)("div",{className:"space-y-2 text-secondary-600",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Subtotal"}),(0,a.jsxs)("span",{children:["$",t.toLocaleString()]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Shipping"}),(0,a.jsx)("span",{children:0===b?"FREE":"$".concat(b)})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Tax"}),(0,a.jsxs)("span",{children:["$",N.toFixed(2)]})]})]}),(0,a.jsx)("hr",{className:"my-4"}),(0,a.jsxs)("div",{className:"flex justify-between text-lg font-bold text-secondary-900",children:[(0,a.jsx)("span",{children:"Total"}),(0,a.jsxs)("span",{children:["$",v.toFixed(2)]})]})]})})]})]})]})}},9008:function(e,s,t){e.exports=t(3867)}},function(e){e.O(0,[888,774,179],function(){return e(e.s=5248)}),_N_E=e.O()}]);